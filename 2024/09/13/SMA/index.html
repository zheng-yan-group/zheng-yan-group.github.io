<!DOCTYPE html>
<html lang="en">
    <head prefix="og: https://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  
  <title>Yan&#39;s group</title>
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    <link rel='manifest' href='/manifest.json'>
  

  
  
  
  <meta property="og:title" content="Yan&#39;s group" />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="http://example.com/2024/09/13/SMA/index.html" />
  
  <meta property="og:image" content="/favicon.png" />
  
  <meta property="og:article:published_time" content="2024-09-13T12:02:35.740Z" />
  
  <meta property="og:article:author" content="Yiming Ding" />
  
  

  
<link rel="stylesheet" href="/css/var.css">

  
<link rel="stylesheet" href="/css/main.css">

  
<link rel="stylesheet" href="/css/typography.css">

  
<link rel="stylesheet" href="/css/code-highlighting.css">

  
<link rel="stylesheet" href="/css/components.css">

  
<link rel="stylesheet" href="/css/nav.css">

  
<link rel="stylesheet" href="/css/paginator.css">

  
<link rel="stylesheet" href="/css/footer.css">

  
<link rel="stylesheet" href="/css/post-list.css">

  
  
<link rel="stylesheet" href="/css/rainbow-banner.css">

  
  
  
  
  
  
<link rel="stylesheet" href="/css/post.css">

  
  
  
  
  

  
<meta name="generator" content="Hexo 6.3.0"></head>
    <body
        data-color-scheme="auto"
        data-uppercase-categories="true"
        
        data-rainbow-banner="true"
        data-rainbow-banner-shown="auto"
        data-rainbow-banner-month="6"
        data-rainbow-banner-colors="#e50000,#ff8d00,#ffee00,#008121,#004cff,#760188"
        
        data-config-root="/"
        
        
    >
        <nav id="theme-nav">
    <div class="inner">
        <a class="title" href="/">Yan&#39;s group</a>
        <div class="nav-arrow"></div>
        <div class="nav-items">
            <a class="nav-item nav-item-home" href="/">Home</a>
            
            
            <a class="nav-item" href="/research">Research</a>
            
            
            
            <a class="nav-item" href="/people">People</a>
            
            
            
            <a class="nav-item" href="/publications">Publications</a>
            
            
            
            <a class="nav-item" href="/teaching">Teaching</a>
            
            
            
            <a class="nav-item" href="/gallery">Gallery</a>
            
            
            
            <a class="nav-item" href="/join">Join us</a>
            
            
        </div>
    </div>
</nav>
        
<article class="post">
    <div class="meta">
        

        

        <h2 class="title"></h2>
    </div>

    <div class="divider"></div>

    <div class="content">
        <h1 id="Single-mode-approximation-SMA"><a href="#Single-mode-approximation-SMA" class="headerlink" title="Single-mode approximation (SMA)"></a>Single-mode approximation (SMA)</h1><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1 Introduction"></a>1 Introduction</h2><p>The single-mode approximation (SMA) can be used to analyse excitation spectrum of Quantum dimer models (QDMs). </p>
<h3 id="1-1-Hamilton"><a href="#1-1-Hamilton" class="headerlink" title="1.1 Hamilton"></a>1.1 Hamilton</h3><p><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>H</mi><mo>&#x3D;</mo><mo>&#x2212;</mo><mi>t</mi><munder><mo data-mjx-texclass="OP">&#x2211;</mo><mi>r</mi></munder><mo stretchy="false">(</mo><mo stretchy="false">|</mo><mo stretchy="false">|</mo><mo stretchy="false">|</mo><mo>&gt;&lt;&#x3D;</mo><mo stretchy="false">|</mo><mo>+</mo><mo stretchy="false">|</mo><mo>&#x3D;&gt;&lt;</mo><mo stretchy="false">|</mo><mo stretchy="false">|</mo><mo stretchy="false">|</mo><mo stretchy="false">)</mo><mo>+</mo><mi>v</mi><munder><mo data-mjx-texclass="OP">&#x2211;</mo><mi>r</mi></munder><mo stretchy="false">(</mo><mo stretchy="false">|</mo><mo stretchy="false">|</mo><mo stretchy="false">|</mo><mo>&gt;&lt;</mo><mo stretchy="false">|</mo><mo stretchy="false">|</mo><mo stretchy="false">|</mo><mo>+</mo><mo stretchy="false">|</mo><mo>&#x3D;&gt;&lt;&#x3D;</mo><mo stretchy="false">|</mo><mo stretchy="false">)</mo></math></p>
<p>where the first term is the kinetic term, which describes flipping two dimers on every flippable plaquette, and the second term represents a repulsion between two parallel dimers</p>
<p>We focus on a special point, namely, the Rokhsar-Kivelson (RK) point (v&#x3D;t&#x3D;1), at which the ground state (<math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">|</mo><mi>G</mi><mi>S</mi><mo>&gt;</mo></math>) of the Hamilton is exactly solvable as an equal amplitude superposition of all dimer coverings (<math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">|</mo><mi>C</mi><mo>&gt;</mo></math>).</p>
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">|</mo><mi>G</mi><mi>S</mi><mo>&gt;&#x3D;</mo><munder><mo data-mjx-texclass="OP">&#x2211;</mo><mrow data-mjx-texclass="ORD"><mi>C</mi></mrow></munder><msub><mi>A</mi><mi>C</mi></msub><mo stretchy="false">|</mo><mi>C</mi><mo>&gt;</mo></math></p>
<p>Dimer covering is that each vertex in the lattice touches exactly one dimer under certain constraints.</p>
<h3 id="1-2-SMA"><a href="#1-2-SMA" class="headerlink" title="1.2 SMA"></a>1.2 SMA</h3><p>We define a state <math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">|</mo><mi>q</mi><mo>&gt;&#x3D;</mo><msub><mi>D</mi><mi>&#x3B1;</mi></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo stretchy="false">|</mo><mi>G</mi><mi>S</mi><mo>&gt;</mo></math>, where the density operator <math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>D</mi><mi>&#x3B1;</mi></msub><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>&#x3D;</mo><mfrac><mn>1</mn><msqrt><mi>N</mi></msqrt></mfrac><munder><mo data-mjx-texclass="OP">&#x2211;</mo><mi>r</mi></munder><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>&#x2212;</mo><mi>i</mi><mi>q</mi><mo>.</mo><mi>r</mi><mo stretchy="false">)</mo><msub><mi>n</mi><mi>&#x3B1;</mi></msub><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math> and <math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mi>&#x3B1;</mi></msub><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></math> is dimer number operator. Energy can be  defined as:</p>
<p><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>&#x3C9;</mi><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo><mo>&#x3D;</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mfrac><mrow><mo>&lt;</mo><mi>G</mi><mi>S</mi><mo stretchy="false">|</mo><mo stretchy="false">[</mo><msub><mrow data-mjx-texclass="ORD"><mover><mi>D</mi><mo stretchy="false">^</mo></mover></mrow><mi>x</mi></msub><mo stretchy="false">(</mo><mo>&#x2212;</mo><mi>Q</mi><mo stretchy="false">)</mo><mo>,</mo><mo stretchy="false">[</mo><mi>H</mi><mo>,</mo><msub><mrow data-mjx-texclass="ORD"><mover><mi>D</mi><mo stretchy="false">^</mo></mover></mrow><mi>x</mi></msub><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo stretchy="false">|</mo><mi>G</mi><mi>S</mi><mo>&gt;</mo></mrow><mrow><msub><mi>D</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow></mfrac></math></p>
<h2 id="2-code"><a href="#2-code" class="headerlink" title="2 code"></a>2 code</h2><p>We present  SMA dispersion of  the square lattice  using fortran language.</p>
<h3 id="2-1-Define-parameters"><a href="#2-1-Define-parameters" class="headerlink" title="2.1 Define parameters"></a>2.1 Define parameters</h3><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> configuration</span><br><span class="line"><span class="keyword">save</span></span><br><span class="line"><span class="keyword">integer</span> :: lx=<span class="number">64</span>,nbins=<span class="number">10</span>     <span class="comment">!system size:lx*ly  </span></span><br><span class="line"><span class="keyword">integer</span> :: ly,path</span><br><span class="line"><span class="keyword">integer</span> :: nn,np      <span class="comment">!nn:the number of bond along x-direction   np: the number of plaquette    </span></span><br><span class="line"><span class="keyword">integer</span> :: nb         <span class="comment">!nb: the number of bond alond x and y direction</span></span><br><span class="line"><span class="keyword">real</span>(<span class="number">8</span>) :: beta,qx=<span class="number">0</span>,qy=<span class="number">0</span>     <span class="comment">!qx,qy:  the value of momentum space</span></span><br><span class="line"><span class="keyword">integer</span>, <span class="keyword">allocatable</span> :: bond(:),bondold(:)   </span><br><span class="line"><span class="keyword">integer</span>, <span class="keyword">allocatable</span> :: bsites(:,:)   </span><br><span class="line"><span class="keyword">complex</span>(<span class="number">8</span>),<span class="keyword">parameter</span>:: ipi2=(<span class="number">0</span>,<span class="number">1.5707963268</span>),ipi=<span class="number">2</span>*ipi2</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">module</span> configuration</span><br></pre></td></tr></table></figure>



<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> measurementdata</span><br><span class="line"> <span class="keyword">save</span></span><br><span class="line"> <span class="keyword">complex</span> :: d_d=<span class="number">0.d0</span>      <span class="comment">!&lt;GS|D(-q)D(q)|GS&gt;</span></span><br><span class="line"> <span class="keyword">complex</span> :: d_hd=<span class="number">0.d0</span>     <span class="comment">!&lt;GS|D(-q)HD(q)|GS&gt;</span></span><br><span class="line"> <span class="keyword">complex</span> :: dh_d=<span class="number">0.d0</span>     <span class="comment">!&lt;GS|D(q)HD(-q)|GS&gt;</span></span><br><span class="line"> <span class="keyword">real</span>(<span class="number">8</span>) :: data1(<span class="number">7</span>)=<span class="number">0.d0</span> </span><br><span class="line"> <span class="keyword">real</span>(<span class="number">8</span>) :: data2(<span class="number">7</span>)=<span class="number">0.d0</span> </span><br><span class="line"> <span class="keyword">end</span> <span class="keyword">module</span> measurementdata</span><br></pre></td></tr></table></figure>

<h3 id="2-2-Encode-each-bond-of-the-lattice"><a href="#2-2-Encode-each-bond-of-the-lattice" class="headerlink" title="2.2 Encode each bond of the lattice"></a>2.2 Encode each bond of the lattice</h3><p>The system is made up of <strong>np</strong> plaquettes, and the bonds of each plaquette are coded in turn</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">subroutine</span></span> makelattice()</span><br><span class="line"> <span class="keyword">use</span> configuration; <span class="keyword">implicit</span> <span class="keyword">none</span></span><br><span class="line"> <span class="keyword">integer</span> :: s,x,y,z,i</span><br><span class="line"> nn=lx*ly</span><br><span class="line"> nb=<span class="number">2</span>*nn</span><br><span class="line"> np=nn   </span><br><span class="line"> </span><br><span class="line"><span class="comment">!|-2-|</span></span><br><span class="line"><span class="comment">!3   4  </span></span><br><span class="line"><span class="comment">!|-1-| </span></span><br><span class="line"></span><br><span class="line"> <span class="built_in">allocate</span>(bsites(<span class="number">4</span>,np))</span><br><span class="line"> <span class="keyword">do</span> s=<span class="number">1</span>,nn</span><br><span class="line">    bsites(<span class="number">1</span>,s)=s</span><br><span class="line">    x=s+lx</span><br><span class="line">    <span class="keyword">if</span> (x&gt;nn) <span class="keyword">then</span></span><br><span class="line">        bsites(<span class="number">2</span>,s)=x-nn</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        bsites(<span class="number">2</span>,s)=x</span><br><span class="line">    <span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line">    bsites(<span class="number">3</span>,s)=s+nn</span><br><span class="line">    x=s+nn</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">mod</span>(x,lx)==<span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">         bsites(<span class="number">4</span>,s)=x-lx+<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">         bsites(<span class="number">4</span>,s)=x+<span class="number">1</span></span><br><span class="line">    <span class="keyword">endif</span></span><br><span class="line"> <span class="keyword">enddo</span></span><br><span class="line"> <span class="keyword">end</span> <span class="function"><span class="keyword">subroutine</span></span> makelattice</span><br></pre></td></tr></table></figure>

<h3 id="2-3-Initial-configuration"><a href="#2-3-Initial-configuration" class="headerlink" title="2.3 Initial configuration"></a>2.3 Initial configuration</h3><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">!Generate random numbers</span></span><br><span class="line"><span class="keyword">real</span>(<span class="number">8</span>) <span class="function"><span class="keyword">function</span></span> ran()</span><br><span class="line"> <span class="keyword">implicit</span> <span class="keyword">none</span></span><br><span class="line"> <span class="keyword">real</span>(<span class="number">8</span>)    :: dmu64</span><br><span class="line"> <span class="keyword">integer</span>(<span class="number">8</span>) :: ran64,mul64,add64</span><br><span class="line"> <span class="keyword">common</span>/bran64/dmu64,ran64,mul64,add64</span><br><span class="line"></span><br><span class="line"> ran64=ran64*mul64+add64</span><br><span class="line"> ran=<span class="number">0.5d0</span>+dmu64*<span class="built_in">dble</span>(ran64)</span><br><span class="line"></span><br><span class="line"> <span class="keyword">end</span> <span class="function"><span class="keyword">function</span></span> ran</span><br><span class="line"><span class="comment">!---------------------!</span></span><br><span class="line"> <span class="function"><span class="keyword">subroutine</span></span> initran(w)</span><br><span class="line"> <span class="keyword">implicit</span> <span class="keyword">none</span></span><br><span class="line"> <span class="keyword">integer</span>:: myid, numprocs, namelen, rc,ierr ,comm</span><br><span class="line"></span><br><span class="line"> <span class="keyword">integer</span>(<span class="number">8</span>) :: irmax</span><br><span class="line"> <span class="keyword">integer</span>(<span class="number">4</span>) :: w</span><br><span class="line"> <span class="keyword">real</span>(<span class="number">8</span>) :: rdm</span><br><span class="line"> <span class="keyword">real</span>(<span class="number">8</span>)    :: dmu64</span><br><span class="line"> <span class="keyword">integer</span>(<span class="number">8</span>) :: ran64,mul64,add64,ii,i</span><br><span class="line"> <span class="keyword">common</span>/bran64/dmu64,ran64,mul64,add64</span><br><span class="line"></span><br><span class="line"> irmax=<span class="number">2_8</span>**<span class="number">31</span></span><br><span class="line"> irmax=<span class="number">2</span>*(irmax**<span class="number">2</span>-<span class="number">1</span>)+<span class="number">1</span></span><br><span class="line"> mul64=<span class="number">2862933555777941757_8</span></span><br><span class="line"> add64=<span class="number">1013904243</span></span><br><span class="line"> dmu64=<span class="number">0.5d0</span>/<span class="built_in">dble</span>(irmax)</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> ii=<span class="number">1</span>,w</span><br><span class="line"><span class="keyword">call</span> <span class="built_in">random_seed</span>()</span><br><span class="line"><span class="keyword">call</span> <span class="built_in">random_number</span>(rdm)</span><br><span class="line"><span class="keyword">enddo</span></span><br><span class="line"><span class="keyword">do</span> ii=<span class="number">1</span>,w+<span class="number">3</span></span><br><span class="line"><span class="keyword">call</span> <span class="built_in">random_number</span>(rdm)</span><br><span class="line"><span class="keyword">enddo</span></span><br><span class="line">ran64=<span class="built_in">abs</span>((rdm*mul64)/<span class="number">5</span>+<span class="number">5265361</span>)</span><br><span class="line"> <span class="keyword">end</span> <span class="function"><span class="keyword">subroutine</span></span> initran</span><br><span class="line"><span class="comment">!-------------------------------------------------------------------!</span></span><br><span class="line"><span class="comment">!Select the initial configuration (dimer covering) based on random numbers</span></span><br><span class="line"><span class="function"><span class="keyword">subroutine</span></span> initconfig()</span><br><span class="line"> <span class="keyword">use</span> configuration; <span class="keyword">implicit</span> <span class="keyword">none</span></span><br><span class="line"> <span class="keyword">integer</span> :: i,b1,b2,b3,b4,ii,next,s1,s2,bs,v0</span><br><span class="line"> <span class="keyword">real</span>(<span class="number">8</span>),<span class="keyword">external</span> :: ran</span><br><span class="line"> <span class="keyword">real</span>(<span class="number">8</span>) :: rann</span><br><span class="line"></span><br><span class="line"> <span class="built_in">allocate</span>(bondold(nb))</span><br><span class="line"> <span class="built_in">allocate</span>(bond(nb))</span><br><span class="line"> bond(:)=-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">rann=ran()</span><br><span class="line"><span class="built_in">print</span>*,rann</span><br><span class="line"><span class="keyword">if</span> (rann&lt;<span class="number">0.25</span>) <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">do</span> i=<span class="number">1</span>,nn</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">mod</span>((i-<span class="number">1</span>)/lx,<span class="number">4</span>)==<span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">	    <span class="keyword">if</span> (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i)=<span class="number">1</span></span><br><span class="line">		bond(i+lx)=<span class="number">1</span></span><br><span class="line">	           elseif (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">2</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i+nn)=<span class="number">1</span></span><br><span class="line">		bond(i+nn+<span class="number">1</span>)=<span class="number">1</span></span><br><span class="line">	           <span class="keyword">endif</span></span><br><span class="line">	elseif (<span class="built_in">mod</span>((i-<span class="number">1</span>)/lx,<span class="number">4</span>)==<span class="number">2</span>) <span class="keyword">then</span></span><br><span class="line">	           <span class="keyword">if</span> (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">2</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i)=<span class="number">1</span></span><br><span class="line">		bond(i+lx)=<span class="number">1</span></span><br><span class="line">	           elseif (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i+nn)=<span class="number">1</span></span><br><span class="line">		bond(i+nn+<span class="number">1</span>)=<span class="number">1</span></span><br><span class="line">	           <span class="keyword">endif</span></span><br><span class="line">	<span class="keyword">endif</span></span><br><span class="line"> <span class="keyword">enddo</span></span><br><span class="line">elseif (rann&lt;<span class="number">0.5</span>) <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">do</span> i=<span class="number">1</span>,nn</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">mod</span>((i-<span class="number">1</span>)/lx,<span class="number">4</span>)==<span class="number">1</span>) <span class="keyword">then</span></span><br><span class="line">	    <span class="keyword">if</span> (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i)=<span class="number">1</span></span><br><span class="line">		bond(i+lx)=<span class="number">1</span></span><br><span class="line">	    elseif (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">2</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i+nn)=<span class="number">1</span></span><br><span class="line">		bond(i+nn+<span class="number">1</span>)=<span class="number">1</span></span><br><span class="line">	    <span class="keyword">endif</span></span><br><span class="line">	elseif (<span class="built_in">mod</span>((i-<span class="number">1</span>)/lx,<span class="number">4</span>)==<span class="number">3</span>) <span class="keyword">then</span></span><br><span class="line">	    <span class="keyword">if</span> (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">2</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i)=<span class="number">1</span></span><br><span class="line">		ii=i+lx</span><br><span class="line">		<span class="keyword">if</span> (ii&gt;nn) ii=ii-nn</span><br><span class="line">		bond(ii)=<span class="number">1</span></span><br><span class="line">	    elseif (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i+nn)=<span class="number">1</span></span><br><span class="line">		bond(i+nn+<span class="number">1</span>)=<span class="number">1</span></span><br><span class="line">	    <span class="keyword">endif</span></span><br><span class="line">	<span class="keyword">endif</span></span><br><span class="line"> <span class="keyword">enddo</span></span><br><span class="line">elseif (rann&lt;<span class="number">0.75</span>) <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">do</span> i=<span class="number">1</span>,nn</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">mod</span>((i-<span class="number">1</span>)/lx,<span class="number">4</span>)==<span class="number">0</span>) <span class="keyword">then</span></span><br><span class="line">	    <span class="keyword">if</span> (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">1</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i)=<span class="number">1</span></span><br><span class="line">		bond(i+lx)=<span class="number">1</span></span><br><span class="line">	    elseif (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">3</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i+nn)=<span class="number">1</span></span><br><span class="line">		ii=i+nn+<span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">mod</span>(i,lx)==<span class="number">0</span>) ii=ii-lx</span><br><span class="line">		bond(ii)=<span class="number">1</span></span><br><span class="line">	    <span class="keyword">endif</span></span><br><span class="line">	elseif (<span class="built_in">mod</span>((i-<span class="number">1</span>)/lx,<span class="number">4</span>)==<span class="number">2</span>) <span class="keyword">then</span></span><br><span class="line">	    <span class="keyword">if</span> (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">3</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i)=<span class="number">1</span></span><br><span class="line">		bond(i+lx)=<span class="number">1</span></span><br><span class="line">	    elseif (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">1</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i+nn)=<span class="number">1</span></span><br><span class="line">		bond(i+nn+<span class="number">1</span>)=<span class="number">1</span></span><br><span class="line">	    <span class="keyword">endif</span></span><br><span class="line">	<span class="keyword">endif</span></span><br><span class="line"> <span class="keyword">enddo</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"> <span class="keyword">do</span> i=<span class="number">1</span>,nn</span><br><span class="line">	<span class="keyword">if</span> (<span class="built_in">mod</span>((i-<span class="number">1</span>)/lx,<span class="number">4</span>)==<span class="number">1</span>) <span class="keyword">then</span></span><br><span class="line">	    <span class="keyword">if</span> (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">1</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i)=<span class="number">1</span></span><br><span class="line">		bond(i+lx)=<span class="number">1</span></span><br><span class="line">	    elseif (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">3</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i+nn)=<span class="number">1</span></span><br><span class="line">		ii=i+nn+<span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">mod</span>(i,lx)==<span class="number">0</span>) ii=ii-lx</span><br><span class="line">		bond(ii)=<span class="number">1</span></span><br><span class="line">	    <span class="keyword">endif</span></span><br><span class="line">	elseif (<span class="built_in">mod</span>((i-<span class="number">1</span>)/lx,<span class="number">4</span>)==<span class="number">3</span>) <span class="keyword">then</span></span><br><span class="line">	    <span class="keyword">if</span> (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">3</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i)=<span class="number">1</span></span><br><span class="line">		ii=i+lx</span><br><span class="line">		<span class="keyword">if</span> (ii&gt;nn) ii=ii-nn</span><br><span class="line">		bond(ii)=<span class="number">1</span></span><br><span class="line">	    elseif (<span class="built_in">mod</span>(i-<span class="number">1</span>,<span class="number">4</span>)==<span class="number">1</span>) <span class="keyword">then</span></span><br><span class="line">		bond(i+nn)=<span class="number">1</span></span><br><span class="line">		bond(i+nn+<span class="number">1</span>)=<span class="number">1</span></span><br><span class="line">	    <span class="keyword">endif</span></span><br><span class="line">	<span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">enddo</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"> <span class="keyword">end</span> <span class="function"><span class="keyword">subroutine</span></span> initconfig</span><br><span class="line"><span class="comment">!-------------------------------------------------------------------!</span></span><br><span class="line"><span class="comment">!any initial configuration can be obtained from another initial configuration by update (|| change to = or = change to ||)</span></span><br><span class="line"><span class="function"><span class="keyword">subroutine</span></span> update()</span><br><span class="line"> <span class="keyword">use</span> configuration; <span class="keyword">implicit</span> <span class="keyword">none</span></span><br><span class="line"> <span class="keyword">integer</span> :: i,ii</span><br><span class="line"> <span class="keyword">real</span>(<span class="number">8</span>),<span class="keyword">external</span> :: ran</span><br><span class="line"> <span class="keyword">logical</span>,<span class="keyword">external</span> :: bondcheck</span><br><span class="line"> <span class="keyword">do</span> i=<span class="number">1</span>,np</span><br><span class="line">	<span class="keyword">if</span> (bondcheck(i).and.(ran()&lt;<span class="number">0.5</span>)) <span class="keyword">then</span></span><br><span class="line">		<span class="keyword">do</span> ii=<span class="number">1</span>,<span class="number">4</span></span><br><span class="line">		  	 bond(bsites(ii,i))=-bond(bsites(ii,i))</span><br><span class="line">		<span class="keyword">enddo</span></span><br><span class="line">	<span class="keyword">endif</span></span><br><span class="line"> <span class="keyword">enddo</span></span><br><span class="line"> <span class="keyword">end</span> <span class="function"><span class="keyword">subroutine</span></span> update</span><br></pre></td></tr></table></figure>

<h3 id="2-4-Calculate"><a href="#2-4-Calculate" class="headerlink" title="2.4 Calculate"></a>2.4 Calculate</h3><p>calculate <math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#x3C9;</mi></math> ~ <math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math> under SMA</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">subroutine</span></span> measureobservables() </span><br><span class="line">  <span class="keyword">use</span> configuration; <span class="keyword">use</span> measurementdata; <span class="keyword">implicit</span> <span class="keyword">none</span></span><br><span class="line">    <span class="keyword">integer</span> :: i,w,x,y,z,ii</span><br><span class="line">    <span class="keyword">complex</span> :: dq,dqh</span><br><span class="line">    <span class="keyword">logical</span>,<span class="keyword">external</span> :: bondcheck</span><br><span class="line"></span><br><span class="line">      dq=<span class="number">0</span></span><br><span class="line">      <span class="keyword">do</span> i=<span class="number">1</span>,nn</span><br><span class="line">	x=<span class="built_in">mod</span>(i-<span class="number">1</span>,lx)</span><br><span class="line">	y=(i-<span class="number">1</span>)/lx</span><br><span class="line">	dq=dq+<span class="built_in">exp</span>(ipi*(qx*x+qy*y))*bond(i)</span><br><span class="line">      <span class="keyword">enddo</span></span><br><span class="line">       d_d=d_d+dq*<span class="built_in">conjg</span>(dq)</span><br><span class="line"></span><br><span class="line"> 	<span class="keyword">do</span> i=<span class="number">1</span>,np</span><br><span class="line">		<span class="keyword">if</span> (bondcheck(i)) <span class="keyword">then</span></span><br><span class="line">			bondold=bond</span><br><span class="line">			<span class="keyword">do</span> ii=<span class="number">1</span>,<span class="number">4</span></span><br><span class="line">		  		 bondold(bsites(ii,i))=-bondold(bsites(ii,i))</span><br><span class="line">			<span class="keyword">enddo</span></span><br><span class="line"></span><br><span class="line">			dqh=<span class="number">0</span></span><br><span class="line">      			<span class="keyword">do</span> ii=<span class="number">1</span>,nn</span><br><span class="line">				x=<span class="built_in">mod</span>(ii-<span class="number">1</span>,lx)</span><br><span class="line">				y=(ii-<span class="number">1</span>)/lx</span><br><span class="line">				dqh=dqh+<span class="built_in">exp</span>(ipi*(qx*x+qy*y))*bondold(ii)</span><br><span class="line">  			<span class="keyword">enddo</span></span><br><span class="line"></span><br><span class="line">			d_hd=-<span class="built_in">conjg</span>(dqh)*dq+<span class="built_in">conjg</span>(dq)*dq+d_hd   <span class="comment">!&lt;GS|D(-q)HD(q)|GS&gt;</span></span><br><span class="line">			dh_d=-dqh*<span class="built_in">conjg</span>(dq)+dq*<span class="built_in">conjg</span>(dq)+dh_d   <span class="comment">!&lt;GS|D(q)HD(-q)|GS&gt;</span></span><br><span class="line">		<span class="keyword">endif</span></span><br><span class="line">	 <span class="keyword">enddo</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">end</span> <span class="function"><span class="keyword">subroutine</span></span> measureobservables</span><br></pre></td></tr></table></figure>

<h3 id="2-5-main-program"><a href="#2-5-main-program" class="headerlink" title="2.5 main program"></a>2.5 main program</h3><p>we can calculate <math xmlns="http://www.w3.org/1998/Math/MathML"><mi>&#x3C9;</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></math> along the Brillouin zone path <math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo><mo stretchy="false">&#x2192;</mo><mo stretchy="false">(</mo><mi>&#x3C0;</mi><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo><mo stretchy="false">&#x2192;</mo><mo stretchy="false">(</mo><mi>&#x3C0;</mi><mo>,</mo><mi>&#x3C0;</mi><mo stretchy="false">)</mo><mo stretchy="false">&#x2192;</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">program</span></span> basic_heisenberg_sse</span><br><span class="line"> <span class="keyword">use</span> configuration;<span class="keyword">use</span> measurementdata; <span class="keyword">implicit</span> <span class="keyword">none</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">integer</span> :: i,j,msteps=<span class="number">1000</span>,system,ix,iy</span><br><span class="line"> <span class="keyword">character</span>(<span class="number">20</span>)::filename</span><br><span class="line">  <span class="keyword">real</span>(<span class="number">8</span>) :: dqx,dqy</span><br><span class="line"></span><br><span class="line">  beta=<span class="number">0</span></span><br><span class="line">    ly=lx</span><br><span class="line">     dqx=<span class="number">2.d0</span>/lx</span><br><span class="line">     dqy=<span class="number">2.d0</span>/ly</span><br><span class="line"></span><br><span class="line"> <span class="keyword">call</span> initran(<span class="number">8</span>)</span><br><span class="line"> <span class="keyword">call</span> makelattice()</span><br><span class="line"> <span class="keyword">call</span> initconfig()</span><br><span class="line"></span><br><span class="line">path=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> ix=<span class="number">0</span>,lx/<span class="number">2</span>   <span class="comment">! path 1 from (0,0) to (1,0)</span></span><br><span class="line">     qx=dqx*ix</span><br><span class="line">     qy=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">do</span> j=<span class="number">1</span>,nbins</span><br><span class="line">    <span class="keyword">do</span> i=<span class="number">1</span>,msteps</span><br><span class="line">       <span class="keyword">call</span> update()</span><br><span class="line">       <span class="keyword">call</span> measureobservables()</span><br><span class="line">    <span class="keyword">enddo</span></span><br><span class="line">    <span class="keyword">call</span> writeresults(msteps,j)</span><br><span class="line"> <span class="keyword">enddo</span></span><br><span class="line"><span class="built_in">print</span>*,path</span><br><span class="line">path=path+<span class="number">1</span></span><br><span class="line"><span class="keyword">enddo</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> iy=<span class="number">1</span>,ly/<span class="number">2</span>   <span class="comment">! path 2 from (1,2/ly) to (1,1)</span></span><br><span class="line">     qx=<span class="number">1</span></span><br><span class="line">     qy=dqy*iy</span><br><span class="line"> <span class="keyword">do</span> j=<span class="number">1</span>,nbins</span><br><span class="line">    <span class="keyword">do</span> i=<span class="number">1</span>,msteps</span><br><span class="line">       <span class="keyword">call</span> update()</span><br><span class="line">       <span class="keyword">call</span> measureobservables()</span><br><span class="line">    <span class="keyword">enddo</span></span><br><span class="line">    <span class="keyword">call</span> writeresults(msteps,j)</span><br><span class="line"> <span class="keyword">enddo</span></span><br><span class="line"><span class="built_in">print</span>*,path</span><br><span class="line">path=path+<span class="number">1</span></span><br><span class="line"><span class="keyword">enddo</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> iy=<span class="number">1</span>,ly/<span class="number">2</span>-<span class="number">1</span>   <span class="comment">! path 3 from (1-2/lx,1-2/ly) to (2/lx,2/ly)</span></span><br><span class="line">     qx=<span class="number">1</span>-dqx*iy</span><br><span class="line">     qy=<span class="number">1</span>-dqy*iy</span><br><span class="line"> <span class="keyword">do</span> j=<span class="number">1</span>,nbins</span><br><span class="line">    <span class="keyword">do</span> i=<span class="number">1</span>,msteps</span><br><span class="line">       <span class="keyword">call</span> update()</span><br><span class="line">       <span class="keyword">call</span> measureobservables()</span><br><span class="line">    <span class="keyword">enddo</span></span><br><span class="line">    <span class="keyword">call</span> writeresults(msteps,j)</span><br><span class="line"> <span class="keyword">enddo</span></span><br><span class="line"><span class="built_in">print</span>*,path</span><br><span class="line">path=path+<span class="number">1</span></span><br><span class="line"><span class="keyword">enddo</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">end</span> <span class="function"><span class="keyword">program</span></span> basic_heisenberg_sse</span><br></pre></td></tr></table></figure>

<h3 id="2-6-Save"><a href="#2-6-Save" class="headerlink" title="2.6 Save"></a>2.6 Save</h3><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">subroutine</span></span> writeresults(msteps,bins)</span><br><span class="line"> <span class="keyword">use</span> configuration; <span class="keyword">use</span> measurementdata; <span class="keyword">implicit</span> <span class="keyword">none</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">integer</span> :: i,msteps,bins,j</span><br><span class="line"> <span class="keyword">real</span>(<span class="number">8</span>) :: wdata1(<span class="number">7</span>),wdata2(<span class="number">7</span>),t,tt</span><br><span class="line"> <span class="keyword">character</span>(<span class="number">20</span>)::filename</span><br><span class="line"></span><br><span class="line"> d_d=d_d/msteps</span><br><span class="line"> d_hd=d_hd/msteps</span><br><span class="line"> dh_d=dh_d/msteps</span><br><span class="line"></span><br><span class="line"> data1(<span class="number">1</span>)=data1(<span class="number">1</span>)+<span class="keyword">real</span>(d_hd+dh_d)         <span class="comment">!molecule</span></span><br><span class="line"> data1(<span class="number">2</span>)=data1(<span class="number">2</span>)+<span class="keyword">real</span>(d_d)               <span class="comment">!denominator</span></span><br><span class="line"> data1(<span class="number">3</span>)=data1(<span class="number">3</span>)+<span class="keyword">real</span>((d_hd+dh_d)/d_d)   <span class="comment">!$\omega(k)$=molecule/denominator</span></span><br><span class="line"></span><br><span class="line"> data2(<span class="number">1</span>)=data2(<span class="number">1</span>)+<span class="keyword">real</span>(d_hd+dh_d)**<span class="number">2</span></span><br><span class="line"> data2(<span class="number">2</span>)=data2(<span class="number">2</span>)+<span class="keyword">real</span>(d_d)**<span class="number">2</span></span><br><span class="line"> data2(<span class="number">3</span>)=data2(<span class="number">3</span>)+<span class="keyword">real</span>((d_hd+dh_d)/d_d)**<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (bins==nbins) <span class="keyword">then</span></span><br><span class="line"> <span class="keyword">do</span> i=<span class="number">1</span>,<span class="number">3</span></span><br><span class="line">    wdata1(i)=data1(i)/bins</span><br><span class="line">    wdata2(i)=data2(i)/bins</span><br><span class="line">    wdata2(i)=<span class="built_in">sqrt</span>(<span class="built_in">abs</span>(wdata2(i)-wdata1(i)**<span class="number">2</span>)/bins)  <span class="comment">!error</span></span><br><span class="line"> <span class="keyword">enddo</span></span><br><span class="line"></span><br><span class="line">open(<span class="number">114</span>,<span class="keyword">file</span>=<span class="string">&#x27;singlemode.out&#x27;</span>,<span class="keyword">position</span>=<span class="string">&#x27;append&#x27;</span>)</span><br><span class="line"> <span class="built_in">write</span>(<span class="number">114</span>,*) path,wdata1(<span class="number">3</span>),wdata2(<span class="number">3</span>)               <span class="comment">!$\omega(k)$,error</span></span><br><span class="line">close(<span class="number">114</span>)</span><br><span class="line"></span><br><span class="line"> d_d=<span class="number">0.d0</span></span><br><span class="line"> d_hd=<span class="number">0.d0</span></span><br><span class="line"> dh_d=<span class="number">0.d0</span> </span><br><span class="line">  data1=<span class="number">0</span></span><br><span class="line">  data2=<span class="number">0</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"> d_d=<span class="number">0.d0</span></span><br><span class="line"> d_hd=<span class="number">0.d0</span></span><br><span class="line"> dh_d=<span class="number">0.d0</span> </span><br><span class="line"></span><br><span class="line"> <span class="keyword">end</span> <span class="function"><span class="keyword">subroutine</span></span> writeresults</span><br></pre></td></tr></table></figure>

<h3 id="2-7-result"><a href="#2-7-result" class="headerlink" title="2.7 result"></a>2.7 result</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">           0   2.3109267291147261E-003   1.6455131249704898E-003</span><br><span class="line">           1   6.2533550739288328        2.8371740216404522E-002</span><br><span class="line">           2   6.2338413238525394        1.9360616586750323E-002</span><br><span class="line">           3   6.1650729179382324        3.1613608837618649E-002</span><br><span class="line">           4   6.0500032424926760        1.3714428714990519E-002</span><br><span class="line">           5   6.0037383079528812        1.9249298396639518E-002</span><br><span class="line">           6   5.9165374279022220        2.1233933146458623E-002</span><br><span class="line">           7   5.7899007320404055        2.8688790663723224E-002</span><br><span class="line">           8   5.6288352012634277        1.8761953328172567E-002</span><br><span class="line">           9   5.4782701969146732        2.0462955105951773E-002</span><br><span class="line">          10   5.2886437892913820        1.8608940897921072E-002</span><br><span class="line">          11   5.1159195423126222        2.9567157318989505E-002</span><br><span class="line">          12   4.9549531936645508        3.1430773070696548E-002</span><br><span class="line">          13   4.7688477993011471        2.2452612557261262E-002</span><br><span class="line">          14   4.5479550838470457        3.4032958196832191E-002</span><br><span class="line">          15   4.3106336593627930        2.7898038113185218E-002</span><br><span class="line">          16   4.0874701976776127        1.9144380955909032E-002</span><br><span class="line">          17   3.8585180997848512        1.8609396875997147E-002</span><br><span class="line">          18   3.6879651308059693        2.8949933454666853E-002</span><br><span class="line">          19   3.4377574205398558        1.3578068743458328E-002</span><br><span class="line">          20   3.2064547300338746        2.3255134860630623E-002</span><br><span class="line">          21   3.0808235883712767        1.7470583451202289E-002</span><br><span class="line">          22   2.8069951295852662        2.7647364421329677E-002</span><br><span class="line">          23   2.6070729732513427        3.1670710734098995E-002</span><br><span class="line">          24   2.3810294151306151        2.9796689027380193E-002</span><br><span class="line">          25   2.1672029972076414        1.5971279337898391E-002</span><br><span class="line">          26   1.9511149644851684        2.4473548559234566E-002</span><br><span class="line">          27   1.7901781082153321        2.7286673718311588E-002</span><br><span class="line">          28   1.5865640401840211        3.0836123899655121E-002</span><br><span class="line">          29   1.4178456902503966        8.3789057141076002E-003</span><br><span class="line">          30   1.2026528716087341        2.2951941343578548E-002</span><br><span class="line">          31   1.0390071272850037        3.5212021284243736E-002</span><br><span class="line">          32   1.0437846541404725        5.8329403870753194E-002</span><br><span class="line">          33   1.1121289670467376        3.9334604709095188E-002</span><br><span class="line">          34   1.1652176260948182        3.1558839284690707E-002</span><br><span class="line">          35   1.3745294094085694        2.6431431765275463E-002</span><br><span class="line">          36   1.4345147013664246        2.1629957788136263E-002</span><br><span class="line">          37   1.5875914335250854        2.3702880111387638E-002</span><br><span class="line">          38   1.6517681121826171        1.9230563668579375E-002</span><br><span class="line">          39   1.7615051031112672        1.4488433511898375E-002</span><br><span class="line">          40   1.7648772358894349        1.6782384033197116E-002</span><br><span class="line">          41   1.7525395989418029        1.0795956488940417E-002</span><br><span class="line">          42   1.7853079319000245        1.5847920523460547E-002</span><br><span class="line">          43   1.7468797206878661        7.6477434141953996E-003</span><br><span class="line">          44   1.7073505759239196        8.0664708338772963E-003</span><br><span class="line">          45   1.6498860597610474        1.0242478225224066E-002</span><br><span class="line">          46   1.5684979915618897        8.8734704527437969E-003</span><br><span class="line">          47   1.4898424744606018        5.6957569787166405E-003</span><br><span class="line">          48   1.3665797352790832        7.4285902427473982E-003</span><br><span class="line">          49   1.2612158417701722        8.3717839929171971E-003</span><br><span class="line">          50   1.1421930313110351        6.8612852659099147E-003</span><br><span class="line">          51   1.0288167774677277        7.4561234512739369E-003</span><br><span class="line">          52  0.91099560260772705        5.7387275971854494E-003</span><br><span class="line">          53  0.78420571088790891        4.1084180922130774E-003</span><br><span class="line">          54  0.66706750988960262        4.9506690982011343E-003</span><br><span class="line">          55  0.55218040943145752        5.5888892459151265E-003</span><br><span class="line">          56  0.43570946753025053        3.7497197571224258E-003</span><br><span class="line">          57  0.34641086459159853        2.3768882259739979E-003</span><br><span class="line">          58  0.25858314335346222        3.4487059424092325E-003</span><br><span class="line">          59  0.18344641476869583        1.6080926161550495E-003</span><br><span class="line">          60  0.11753480210900306        1.8062113973221030E-003</span><br><span class="line">          61   6.6618058830499649E-002   5.4123314049076877E-004</span><br><span class="line">          62   3.0812994204461576E-002   7.8286098196079113E-004</span><br><span class="line">          63   7.0903261657804251E-003   5.8438091546916360E-004</span><br><span class="line">          64   0.0000000000000000        0.0000000000000000     </span><br><span class="line">          65   1.5889596939086915E-002   5.2551528107296812E-004</span><br><span class="line">          66   6.1861097440123559E-002   1.4868592619685179E-003</span><br><span class="line">          67  0.13374220281839372        1.5077039254814428E-003</span><br><span class="line">!!! do not forget 1/2 (SMA)</span><br></pre></td></tr></table></figure>



<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p>[1] Luchli, Andreas M., Sylvain Capponi, and Fakher F. Assaad. Dynamical dimer correlations at bipartite and non-bipartite RokhsarKivelson points. <em>Journal of Statistical Mechanics: Theory and Experiment</em> 2008.01 (2008): P01010.</p>
<p>[2] Yan, Zheng, et al. Widely existing mixed phase structure of the quantum dimer model on a square lattice. Physical Review B 103.9 (2021): 094421.</p>

    </div>


    
        
        
    
</article>

        <footer>
    <div class="inner">
        <div class="links">
            
            <div class="group">
                <h2 class="title">Home</h2>
                
                <a href="/research" class="item">Research</a>
                
                <a href="/people" class="item">People</a>
                
                <a href="/publications" class="item">Publications</a>
                
                <a href="/teaching" class="item">Teaching</a>
                
                <a href="/gallery" class="item">Gallery</a>
                
            </div>
            
            <div class="group">
                <h2 class="title">Contact</h2>
                
                <a href="/join" class="item">Join us</a>
                
                <a href="mailto:zhengyan@westlake.edu.cn" class="item">Email</a>
                
            </div>
            
        </div>
        <span>&copy; 2024 Powered by <a href="http://hexo.io/" target="_blank">Hexo-cupertino</a> </span>
        
        
            <br>
            <div class="color-scheme-toggle" role="radiogroup" id="theme-color-scheme-toggle">
                <label>
                    <input type="radio" value="light">
                    <span>Light</span>
                </label>
                <label>
                    <input type="radio" value="dark">
                    <span>Dark</span>
                </label>
                <label>
                    <input type="radio" value="auto">
                    <span>Auto</span>
                </label>
            </div>
        
    </div>
</footer>


        
<script src="/js/main.js"></script>

        
        
        

        
        <script src="https://unpkg.com/scrollreveal"></script>
        <script>
            window.addEventListener('load', () => {
                ScrollReveal({ delay: 250, reset: true, easing: 'cubic-bezier(0, 0, 0, 1)' })
                ScrollReveal().reveal('.post-list-item .cover-img img')
                ScrollReveal().reveal('.post-list-item, .card, .content p img, .content .block-large img', { distance: '60px', origin: 'bottom', duration: 800 })
            })
        </script>
        
    </body>
</html>